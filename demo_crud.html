<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo CRUD –¥–ª—è —Å—Ç–µ–Ω–¥–æ–≤</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .btn-danger {
            background: #dc3545;
        }
        .btn-danger:hover {
            background: #c82333;
        }
        .stands {
            margin: 20px 0;
        }
        .stand {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .form-group {
            margin: 10px 0;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
        }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>üéØ Demo CRUD –¥–ª—è —Å—Ç–µ–Ω–¥–æ–≤</h1>

    <div>
        <button class="btn" onclick="loadStands()">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–µ–Ω–¥—ã</button>
        <button class="btn" onclick="showCreateForm()">‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å—Ç–µ–Ω–¥</button>
    </div>

    <div id="create-form" style="display: none; border: 1px solid #ddd; padding: 20px; margin: 20px 0; border-radius: 5px;">
        <h3>–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å—Ç–µ–Ω–¥–∞</h3>
        <div class="form-group">
            <label>ID —Å—Ç–µ–Ω–¥–∞:</label>
            <input type="text" id="new-id" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: new_stand">
        </div>
        <div class="form-group">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
            <input type="text" id="new-title" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: üéØ –ù–æ–≤—ã–π —Å—Ç–µ–Ω–¥">
        </div>
        <div class="form-group">
            <label>–û–ø–∏—Å–∞–Ω–∏–µ:</label>
            <input type="text" id="new-description" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–µ–Ω–¥–∞">
        </div>
        <div class="form-group">
            <label>Emoji:</label>
            <input type="text" id="new-emoji" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: üéØ">
        </div>
        <div class="form-group">
            <label>–¶–≤–µ—Ç:</label>
            <input type="text" id="new-color" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: üî¥">
        </div>
        <div class="form-group">
            <label>–í–æ–ø—Ä–æ—Å:</label>
            <input type="text" id="new-question" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–∞–∫–æ–π —ç—Ç–æ —Å—Ç–µ–Ω–¥?">
        </div>
        <div class="form-group">
            <label>–û—Ç–≤–µ—Ç—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
            <input type="text" id="new-answers" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –Ω–æ–≤—ã–π, —Ç–µ—Å—Ç–æ–≤—ã–π">
        </div>
        <div class="form-group">
            <label>–ü–æ–¥—Å–∫–∞–∑–∫–∞:</label>
            <input type="text" id="new-hint" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–æ–¥—É–º–∞–π—Ç–µ –æ –Ω–æ–≤–∏–∑–Ω–µ">
        </div>
        <button class="btn" onclick="createStand()">üíæ –°–æ–∑–¥–∞—Ç—å</button>
        <button class="btn-danger" onclick="hideCreateForm()">‚ùå –û—Ç–º–µ–Ω–∞</button>
    </div>

    <div id="stands-container">
        <p>–ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–µ–Ω–¥—ã" —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å–ø–∏—Å–æ–∫</p>
    </div>

    <script>
        const API_BASE = 'http://localhost:8080';

        async function loadStands() {
            try {
                const response = await fetch(`${API_BASE}/api/realtime/stands`);
                const stands = await response.json();

                const container = document.getElementById('stands-container');
                container.innerHTML = '<h2>üìã –°–ø–∏—Å–æ–∫ —Å—Ç–µ–Ω–¥–æ–≤:</h2>';

                stands.forEach(stand => {
                    const standDiv = document.createElement('div');
                    standDiv.className = 'stand';
                    standDiv.innerHTML = `
                        <h3>${stand.emoji} ${stand.title} (ID: ${stand.id})</h3>
                        <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${stand.description}</p>
                        <p><strong>–¶–≤–µ—Ç:</strong> ${stand.color}</p>
                        <p><strong>–í–æ–ø—Ä–æ—Å–æ–≤:</strong> ${stand.questions ? stand.questions.length : 0}</p>
                        ${stand.questions && stand.questions.length > 0 ? `
                            <details>
                                <summary>–ü–æ–∫–∞–∑–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã</summary>
                                ${stand.questions.map(q => `
                                    <div style="margin: 10px 0; padding: 10px; background: #f5f5f5; border-radius: 3px;">
                                        <strong>–í–æ–ø—Ä–æ—Å:</strong> ${q.question}<br>
                                        <strong>–û—Ç–≤–µ—Ç—ã:</strong> ${q.answers.join(', ')}<br>
                                        <strong>–ü–æ–¥—Å–∫–∞–∑–∫–∞:</strong> ${q.hint}
                                    </div>
                                `).join('')}
                            </details>
                        ` : ''}
                        <button class="btn btn-danger" onclick="deleteStand('${stand.id}')">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    `;
                    container.appendChild(standDiv);
                });

                console.log('–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å—Ç–µ–Ω–¥–æ–≤:', stands.length);
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message);
            }
        }

        function showCreateForm() {
            document.getElementById('create-form').style.display = 'block';
        }

        function hideCreateForm() {
            document.getElementById('create-form').style.display = 'none';
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            ['new-id', 'new-title', 'new-description', 'new-emoji', 'new-color', 'new-question', 'new-answers', 'new-hint'].forEach(id => {
                document.getElementById(id).value = '';
            });
        }

        async function createStand() {
            const newStand = {
                id: document.getElementById('new-id').value,
                title: document.getElementById('new-title').value,
                description: document.getElementById('new-description').value,
                emoji: document.getElementById('new-emoji').value,
                color: document.getElementById('new-color').value,
                questions: []
            };

            const question = document.getElementById('new-question').value;
            const answers = document.getElementById('new-answers').value;
            const hint = document.getElementById('new-hint').value;

            if (question && answers) {
                newStand.questions.push({
                    question: question,
                    answers: answers.split(',').map(a => a.trim()),
                    hint: hint
                });
            }

            try {
                const response = await fetch(`${API_BASE}/api/stands/create`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(newStand)
                });

                const result = await response.json();
                if (result.success) {
                    alert('–°—Ç–µ–Ω–¥ —Å–æ–∑–¥–∞–Ω!');
                    hideCreateForm();
                    loadStands();
                } else {
                    alert('–û—à–∏–±–∫–∞: ' + result.error);
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞: ' + error.message);
            }
        }

        async function deleteStand(standId) {
            if (!confirm(`–£–¥–∞–ª–∏—Ç—å —Å—Ç–µ–Ω–¥ "${standId}"?`)) {
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/api/stands/delete`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ id: standId })
                });

                const result = await response.json();
                if (result.success) {
                    alert('–°—Ç–µ–Ω–¥ —É–¥–∞–ª–µ–Ω!');
                    loadStands();
                } else {
                    alert('–û—à–∏–±–∫–∞: ' + result.error);
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞: ' + error.message);
            }
        }

        // –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = loadStands;
    </script>
</body>
</html>